 <!DOCTYPE html>
 <html>
 <head>
   <meta charset="UTF-8">
  <link href="res/prism.css" rel="stylesheet" />
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      font-size: 16px;
    }
    code {
      font-size: 16px;
      font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;
    }
  </style>
</head>
<body>
<p>The task requires the following:</p>
<ol>
<li>Complete the implementation of three static attributes (<code>loadFromStream</code>, <code>collectionToMap</code>, and <code>getValuesForTime</code>) in the <code>HPIProcessor</code> class as shown in the class diagram.</li>
<li>Add additional methods to the <code>HousePriceIndex</code> class if needed.</li>
</ol>
<p>The static attribute <code>loadFromStream</code> in the <code>HPIProcessor</code> class is of type <code>Function</code>, and its <code>apply</code> method is used to load data from a Hash Separated Values (HSV) file into a set of type <code>Set&lt;HousePriceIndex&gt;</code>. In the <code>HPIProcessor</code> class, the static attribute <code>collectionToMap</code> converts the loaded set into a map of type <code>Map&lt;String, Double&gt;</code>, while the static attribute <code>getValuesForTime</code> uses that map to calculate statistics.</p>
<p><strong>Note:</strong> Each of these 3 static attributes should be implemented as a lambda expression using the Java Stream API (i.e., collection streams). Exception handling is not required during implementation. The <code>HPIProcessor</code> class should be located in the <code>hr.fer.oop.hpi</code> package, and both the class and its static attributes should have <em>public</em> visibility.</p>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="415px" preserveAspectRatio="none" style="width:1153px;height:415px;background:#FFFFFF;" version="1.1" viewBox="0 0 1153 415" width="1153px" zoomAndPan="magnify">
<defs/>
<g>
<!--MD5=[b8a4a4c0382a36168ac7e3f89796f766]
class HPIProcessor-->
<g id="elem_HPIProcessor">
<rect codeLine="1" fill="#F1F1F1" height="113.1875" id="HPIProcessor" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="717" x="7" y="56"/>
<ellipse cx="315.25" cy="72" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/>
<path d="M318.2188,77.6406 Q317.6406,77.9375 317,78.0781 Q316.3594,78.2344 315.6563,78.2344 Q313.1563,78.2344 311.8281,76.5938 Q310.5156,74.9375 310.5156,71.8125 Q310.5156,68.6875 311.8281,67.0313 Q313.1563,65.375 315.6563,65.375 Q316.3594,65.375 317,65.5313 Q317.6563,65.6875 318.2188,65.9844 L318.2188,68.7031 Q317.5938,68.125 317,67.8594 Q316.4063,67.5781 315.7813,67.5781 Q314.4375,67.5781 313.75,68.6563 Q313.0625,69.7188 313.0625,71.8125 Q313.0625,73.9063 313.75,74.9844 Q314.4375,76.0469 315.7813,76.0469 Q316.4063,76.0469 317,75.7813 Q317.5938,75.5 318.2188,74.9219 L318.2188,77.6406 Z " fill="#000000"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="335.75" y="76.8467">HPIProcessor</text>
<line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="723" y1="88" y2="88"/>
<ellipse cx="18" cy="101.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="494" x="27" y="104.9951">loadFromStream : Function&lt;Stream&lt;String&gt;, Set&lt;HousePriceIndex&gt;&gt;</text>
<ellipse cx="18" cy="117.9453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="636" x="27" y="121.292">collectionToMap : BiFunction&lt;Set&lt;HousePriceIndex&gt;, RegionType, Map&lt;String, Double&gt;&gt;</text>
<ellipse cx="18" cy="134.2422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="691" x="27" y="137.5889">getValuesForTime : BiFunction&lt;Map&lt;String, Double&gt;, String, Collection&lt;Entry&lt;String, Double&gt;&gt;&gt;</text>
<line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="723" y1="144.8906" y2="144.8906"/>
<ellipse cx="18" cy="158.5391" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="27" y="161.8857">HPIProcessor()</text>
</g>
<!--MD5=[bf2dc7819b5cbcf428d6cc8fb84595bb]
class HousePriceIndex-->
<g id="elem_HousePriceIndex">
<rect codeLine="8" fill="#F1F1F1" height="210.9688" id="HousePriceIndex" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="387" x="759" y="7"/>
<ellipse cx="890.25" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/>
<path d="M893.2188,28.6406 Q892.6406,28.9375 892,29.0781 Q891.3594,29.2344 890.6563,29.2344 Q888.1563,29.2344 886.8281,27.5938 Q885.5156,25.9375 885.5156,22.8125 Q885.5156,19.6875 886.8281,18.0313 Q888.1563,16.375 890.6563,16.375 Q891.3594,16.375 892,16.5313 Q892.6563,16.6875 893.2188,16.9844 L893.2188,19.7031 Q892.5938,19.125 892,18.8594 Q891.4063,18.5781 890.7813,18.5781 Q889.4375,18.5781 888.75,19.6563 Q888.0625,20.7188 888.0625,22.8125 Q888.0625,24.9063 888.75,25.9844 Q889.4375,27.0469 890.7813,27.0469 Q891.4063,27.0469 892,26.7813 Q892.5938,26.5 893.2188,25.9219 L893.2188,28.6406 Z " fill="#000000"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="910.75" y="27.8467">HousePriceIndex</text>
<line style="stroke:#181818;stroke-width:0.5;" x1="760" x2="1145" y1="39" y2="39"/>
<rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="767" y="49.6484"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="779" y="55.9951">region : String</text>
<rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="767" y="65.9453"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174" x="779" y="72.292">regionType : RegionType</text>
<rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="767" y="82.2422"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="779" y="88.5889">time : String</text>
<rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="767" y="98.5391"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="779" y="104.8857">percentage : double</text>
<line style="stroke:#181818;stroke-width:0.5;" x1="760" x2="1145" y1="112.1875" y2="112.1875"/>
<ellipse cx="770" cy="125.8359" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="361" x="779" y="129.1826">HousePriceIndex(String, RegionType, String, double)</text>
<ellipse cx="770" cy="142.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174" x="779" y="145.4795">getPercentage() : double</text>
<ellipse cx="770" cy="158.4297" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="779" y="161.7764">getRegion() : String</text>
<ellipse cx="770" cy="174.7266" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212" x="779" y="178.0732">getRegionType() : RegionType</text>
<ellipse cx="770" cy="191.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="779" y="194.3701">getTime() : String</text>
<ellipse cx="770" cy="207.3203" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="779" y="210.667">toString() : String</text>
</g>
<!--MD5=[c4a419c915b3ae2602504fa49af58ac8]
class RegionType-->
<g id="elem_RegionType">
<rect codeLine="21" fill="#F1F1F1" height="113.1875" id="RegionType" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133" x="592" y="295"/>
<ellipse cx="615.1" cy="311" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/>
<path d="M619.2094,317 L611.4906,317 L611.4906,304.6094 L619.2094,304.6094 L619.2094,306.7656 L613.9438,306.7656 L613.9438,309.4375 L618.7094,309.4375 L618.7094,311.5938 L613.9438,311.5938 L613.9438,314.8438 L619.2094,314.8438 L619.2094,317 Z " fill="#000000"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="630.9" y="315.8467">RegionType</text>
<line style="stroke:#181818;stroke-width:0.5;" x1="593" x2="724" y1="327" y2="327"/>
<ellipse cx="603" cy="340.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="69" x="612" y="343.9951">COUNTRY</text>
<ellipse cx="603" cy="356.9453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="107" x="612" y="360.292">LARGE_REGION</text>
<ellipse cx="603" cy="373.2422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="105" x="612" y="376.5889">SMALL_REGION</text>
<ellipse cx="603" cy="389.5391" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="31" x="612" y="392.8857">CITY</text>
<line style="stroke:#181818;stroke-width:0.5;" x1="593" x2="724" y1="400.1875" y2="400.1875"/>
</g>
<!--MD5=[cdf9dd18fd80c08e79034b600ff0628f]
link HPIProcessor to RegionType-->
<g id="link_HPIProcessor_RegionType">
<path codeLine="28" d="M434.2,169.07 C480.43,206.46 541.22,255.63 587.85,293.35 " fill="none" id="HPIProcessor-to-RegionType" style="stroke:#181818;stroke-width:1.0;"/>
<polygon fill="#181818" points="591.75,296.51,587.2679,287.7401,587.8624,293.3657,582.2369,293.9602,591.75,296.51" style="stroke:#181818;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="548.5" y="261.0669">collectionToMap</text>
</g>
<!--MD5=[72a3be6b08f44c29eaef70bec84edc64]
link HousePriceIndex to RegionType-->
<g id="link_HousePriceIndex_RegionType">
<path codeLine="29" d="M822.69,218.14 C790.58,244.03 757.36,270.8 729.28,293.44 " fill="none" id="HousePriceIndex-to-RegionType" style="stroke:#181818;stroke-width:1.0;"/>
<polygon fill="#181818" points="725.17,296.75,734.6932,294.2385,729.0702,293.6213,729.6873,287.9982,725.17,296.75" style="stroke:#181818;stroke-width:1.0;"/>
<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="780.5" y="261.0669">regionType</text>
</g>
<!--MD5=[166d7ae1dd050c2b33592f487aecb36a]
@startuml
class "HPIProcessor" {
{static}  +  loadFromStream : Function<Stream<String>, Set<HousePriceIndex>>
{static}  +  collectionToMap : BiFunction<Set<HousePriceIndex>, RegionType, Map<String, Double>>
{static}  +  getValuesForTime : BiFunction<Map<String, Double>, String, Collection<Entry<String, Double>>>
+  HPIProcessor()
}

class "HousePriceIndex" {
-  region : String
-  regionType : RegionType
-  time : String
-  percentage : double
+  HousePriceIndex(String, RegionType, String, double)
+  getPercentage() : double
+  getRegion() : String
+  getRegionType() : RegionType
+  getTime() : String
+  toString() : String
}

enum "RegionType" {
{static}  +  COUNTRY
{static}  +  LARGE_REGION
{static}  +  SMALL_REGION
{static}  +  CITY
}

"HPIProcessor" - -> "RegionType" : collectionToMap
"HousePriceIndex" - -> "RegionType" : regionType

@enduml

PlantUML version 1.2022.12(Sun Oct 23 20:12:26 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
-->
</g>
</svg>
<p>Class diagram visibility legend:</p>
<p><img src="res/vidljivost.png" alt="Legenda vidljivosti" /></p>
<p>An example HSV file containing the data to be loaded is as follows:</p>
<pre class="line-numbers"><code class="language-hsv">1#Australia#Q1-2021#122.685
1#Australia#Q2-2021#130.906
1#Australia#Q3-2021#137.483
1#Australia#Q4-2021#143.981
1#Chile#Q1-2021#157.243
1#Chile#Q2-2021#161.874
1#Chile#Q3-2021#164.311
1#Chile#Q4-2021#173.021
</code></pre>
<p>Each line of this HSV file contains the following four values separated by the <code>#</code> symbol:</p>
<ul>
<li><code>Type</code> - region type, where the number <code>1</code> represents a country, number <code>2</code> represents a large region, number <code>3</code> represents a small region, and number <code>4</code> represents a city.</li>
<li><code>Region</code> - the name of the region to which the value refers.</li>
<li><code>Time</code> - the time label (quarter-year) to which the value corresponds.</li>
<li><code>Value</code> - the value representing the house price index as a percentage of the value from the year 2015.</li>
</ul>
<p><strong>Note:</strong> The HSV file may contain data for regions and time labels that are not shown in the example HSV file.</p>
<p>The data from this HSV file is loaded using the <code>apply</code> method of the static attribute <code>loadFromStream</code>, which is of type <code>Function</code>. This method takes one argument <code>lines</code> of type <code>Stream&lt;String&gt;</code>, representing the collection stream of lines from this HSV file. The result of calling this method is of type <code>Set&lt;HousePriceIndex&gt;</code>, representing the set into which the data needs to be loaded from the file. The <code>HousePriceIndex</code> class does not need to be implemented from scratch as it comes with the given code and has the following four <code>private</code> attributes:</p>
<ul>
<li><code>region</code> of type <code>String</code></li>
<li><code>regionType</code> of type <code>RegionType</code> enumeration</li>
<li><code>time</code> of type <code>String</code></li>
<li><code>value</code> of type <code>double</code></li>
</ul>
<p>The provided implementation of the <code>HousePriceIndex</code> class includes a constructor that takes values for all four attributes, getters for each attribute, and an overridden <code>toString</code> method. <strong>Additional methods should be added as needed</strong>. When implementing the <code>HousePriceIndex</code> class, consider that <strong>there won't be two objects of this class with the same region and time</strong>.</p>
<p>The <code>apply</code> method of the static attribute <code>collectionToMap</code>, which is of type <code>BiFunction</code>, takes two arguments. The <code>set</code> argument of type <code>Set&lt;HousePriceIndex&gt;</code> is the set of data loaded by the <code>apply</code> method of the static attribute <code>loadFromStream</code>. The <code>regionType</code> argument of type <code>RegionType</code> represents the region type of interest. The result is a map of type <code>Map&lt;String, Double&gt;</code> that contains only the regions from the <code>set</code> whose region type matches the <code>regionType</code> argument. In this map, the keys of type <code>String</code> represent the region names concatenated with the time label using the <code>#</code> character (e.g., <code>Australia#Q2-2021</code>), and the values of type <code>Double</code> represent the house price index for the region and time label.</p>
<p>The <code>apply</code> method of the static attribute <code>getValuesForTime</code>, which is of type <code>BiFunction</code>, takes two arguments. The <code>map</code> argument of type <code>Map&lt;String, Double&gt;</code> is the map obtained by calling the <code>apply</code> method of the static attribute <code>collectionToMap</code>. The <code>time</code> argument of type <code>String</code> represents the time label for which the house price index needs to be found for each region whose data exists within the <code>map</code>. The result is a collection of objects of type <code>Collection&lt;Entry&lt;String, Double&gt;&gt;</code> with keys of type <code>String</code> representing the region names and values of type <code>Double</code> representing the house price index. This collection must be <strong>sorted in ascending order based on the house price index</strong>. <code>Entry</code> is an interface, so objects of this type should be created using the constructor of the <code>java.util.AbstractMap.SimpleEntry</code> class, which implements this interface.</p>
<p>Example usage of the <code>HPIProcessor</code> class and the static attributes that need to be implemented:</p>
<pre class="line-numbers"><code class="language-java">Map&lt;String, Collection&lt;Entry&lt;Integer, Long&gt;&gt;&gt; map = new HashMap&lt;&gt;();

//just to correctly find the project dir
String startDir = System.getProperty(&quot;project.dir&quot;);
if (startDir == null) {
    startDir = System.getProperty(&quot;user.dir&quot;);
}

try {
    Path path = Path.of(startDir, &quot;src&quot;, &quot;main&quot;, &quot;resources&quot;, &quot;HPI-small.hsv&quot;);
    Set&lt;HousePriceIndex&gt; set = HPIProcessor.loadFromStream.apply(Files.lines(path));
    System.out.println(set);
    Map&lt;String, Double&gt; map = HPIProcessor.collectionToMap.apply(set, RegionType.COUNTRY);            
    System.out.println(&quot;\n&quot; + map);
    Collection&lt;Entry&lt;String, Double&gt;&gt; collection = HPIProcessor.getValuesForTime.apply(map, &quot;Q1-2021&quot;);
    System.out.println(&quot;\n&quot; + collection);
 } catch (IOException ex) {
    System.out.println(&quot;The path does not exist: &quot; + ex);
 }
</code></pre>
<p>Expected output:</p>
<pre class="line-numbers"><code class="language-txt">[HousePriceIndex{region=Chile, regionType=COUNTRY, time=Q2-2021, percentage=161.874}, HousePriceIndex{region=Australia, regionType=COUNTRY, time=Q3-2021, percentage=137.483}, HousePriceIndex{region=Australia, regionType=COUNTRY, time=Q4-2021, percentage=143.981}, HousePriceIndex{region=Chile, regionType=COUNTRY, time=Q1-2021, percentage=157.243}, HousePriceIndex{region=Australia, regionType=COUNTRY, time=Q1-2021, percentage=122.685}, HousePriceIndex{region=Chile, regionType=COUNTRY, time=Q3-2021, percentage=164.311}, HousePriceIndex{region=Chile, regionType=COUNTRY, time=Q4-2021, percentage=173.021}, HousePriceIndex{region=Australia, regionType=COUNTRY, time=Q2-2021, percentage=130.906}]

{Australia#Q3-2021=137.483, Australia#Q2-2021=130.906, Chile#Q2-2021=161.874, Australia#Q4-2021=143.981, Australia#Q1-2021=122.685, Chile#Q1-2021=157.243, Chile#Q3-2021=164.311, Chile#Q4-2021=173.021}

[Australia=122.685, Chile=157.243]
</code></pre>
  <script src="res/prism.js"></script>
</body>
</html>
